from web3 import Web3
import os
from dotenv import load_dotenv

load_dotenv()

rpc_url = os.getenv("RPC_URL_WSS")  # Update this to your local Anvil WebSocket URL

provider = Web3(Web3.WebsocketProvider(rpc_url))


def handle_transaction(tx):
    # Process the transaction
    print(tx)


def main():
    subscription = provider.eth.subscribe("newPendingTransactions", handle_transaction)

    try:
        while True:
            pass  # Keep the script running
    except KeyboardInterrupt:
        subscription.unsubscribe()


if __name__ == "__main__":
    main()
