-include .env

deploy-testnet:;
	@forge script script/DeployVulnerableContract.s.sol:DeployVulnerableContract --rpc-url $(ETHEREUM_CLIENT_URL) --evm-version cancun --account $(DEPLOYER_WALLET) --sender $(DEPLOYER_WALLET_ADDRESS) --broadcast --verify --etherscan-api-key $(ETHERSCAN_API_KEY)

deploy-upgrade-implementation:;
	@forge script script/DeployFixedContract.s.sol:DeployFixedContract --fork-url $(ETHEREUM_CLIENT_URL) --evm-version cancun --account $(DEPLOYER_WALLET) --sender $(DEPLOYER_WALLET_ADDRESS) --broadcast --verify --etherscan-api-key $(ETHERSCAN_API_KEY)

build:;
	@forge build --evm-version cancun

run-test:;
	@forge test --evm-version cancun

deposit:;
	cast send $(ATTACK_CONTRACT_ADDRESS) "deposit()" --value 0.0002ether --rpc-url $(ETHEREUM_CLIENT_URL) --account $(ACCOUNT_WALLET)

attack:;
	cast send $(ATTACK_CONTRACT_ADDRESS) "attack(uint256)" 100000000000000 --value 0ether --rpc-url $(ETHEREUM_CLIENT_URL) --account $(ACCOUNT_WALLET)

withdraw-all:;
	cast send $(ATTACK_CONTRACT_ADDRESS) "withdrawAll()" --value 0ether --rpc-url $(ETHEREUM_CLIENT_URL) --account $(ACCOUNT_WALLET)

get-balance:;
	cast balance $(ATTACK_CONTRACT_ADDRESS) --rpc-url $(ETHEREUM_CLIENT_URL)

get-attack-deposit-value:;
	cast call $(VULNERABLE_CONTRACT_ADDRESS_PROXY) "balances(address)(uint256)" $(ATTACK_CONTRACT_ADDRESS) --rpc-url $(ETHEREUM_CLIENT_URL)

run-anvil-fork:;
	@anvil --fork-url $(ETHEREUM_CLIENT_URL)

check-pause-status:;
	cast call $(VULNERABLE_CONTRACT_ADDRESS_PROXY) "paused()()" --rpc-url $(ETHEREUM_CLIENT_URL)

unpause:;
	cast send $(VULNERABLE_CONTRACT_ADDRESS_PROXY) "unpause()" --rpc-url $(ETHEREUM_CLIENT_URL) --account $(DEPLOYER_WALLET)